{% extends "./base.html" %}

{% block content %}

<h1>Part Tracker</h1>
<div class="button-row">
    <button id="update-btn">Update</button>
    <button id="load-btn">Load Test Data</button>
</div>

{% for item in catagories %}
<div class="part-grid">
    <h3>Catagory: {{ item }}</h3>
    <div class="part-container "> <!--Parts and graph-->
        <div class="part row"> <!--All Parts-->
            {% for part in parts %}
            {% if part.catagory == item %}
            <div class="col"><!--Each part-->

                <p>Merchant: {{ part.merchant }}</p>
                {% with short_list=part.long_name.split %}
                {% with short_slice=short_list|slice:":8" %}
                {% with short_name=short_slice|join:" " %}
                <p>Name: {{ short_name }}</p>
                {% endwith %}
                {% endwith %}
                {% endwith %}
                <p>Brand: {{ part.brand }}</p>
                <p>Current Price: $xxx.xx{{ price}}</p>
                <a href="{{ part.link }}">
                    <img class="part-img" src="{{ part.image }}" alt="PC Case">
                </a>

                <!-- Button trigger modal -->
                <div class="container p-0">
                    <div class="row justify-content-start">
                        <div class="col-3 pr-2">

                            <button class="btn btn-success" type="button" data-bs-toggle="collapse"
                                data-bs-target="#addPartCollapse" aria-expanded="false"
                                aria-controls="addPartCollapse">+</button>
                        </div>
                        <div class="col-3">

                            <button type="button" class="btn btn-danger" data-bs-toggle="modal"
                                data-bs-target="#confModal{{part.id}}">
                                -
                            </button>
                        </div>
                    </div>
                </div>


                <!-- Modal -->
                <div class="modal fade" id="confModal{{part.id}}" tabindex="-1" aria-labelledby="exampleModalLabel"
                    aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header bg-dark">
                                <h1 class="modal-title fs-5" id="exampleModalLabel">Delete?</h1>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                    aria-label="Close"></button>
                            </div>
                            <div class="modal-body bg-dark">
                                Are you sure you would like to delete {{ part.long_name }} ID {{ part.id }}?
                            </div>
                            <div class="modal-footer bg-dark">
                                <form class="form-inline" action="{% url 'part_tracker:delPart' %}" method="post">
                                    {% csrf_token %}
                                    <div class="form-group mx-sm-3 mb-2">
                                        <div class="input-group">
                                            <div class="input-group-append">
                                                <button type="submit" class="btn btn-danger me-2">Delete</button>
                                                <button type="button" class="btn btn-secondary"
                                                    data-bs-dismiss="modal">Close</button>
                                            </div>
                                        </div>
                                        <input type="hidden" name="id" value="{{ part.id }}">
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>


                
            </div><!--End EachPart-->
            {% endif %}
            {% endfor %}
        </div><!--End All Parts-->

        <div class="graph col">
            Fancy Graph Here
        </div>
    </div><!--EndParts and graph-->
</div>

<div class="add-part mt-2">

    <div class="collapse" id="addPartCollapse">
        <form class="form-inline" action="{% url 'part_tracker:addPart' %}" method="post">
            {% csrf_token %}
            <div class="form-group mx-sm-3 mb-2">
                <div class="input-group">
                    <div class="input-group-append">

                        <button type="submit" class="btn btn-primary me-2">Add Part</button>
                    </div>
                    <input type="text" name="link" class="form-control" id="inputPartLink" placeholder="Parts Link">
                </div>
                <input type="hidden" name="catagory" value="{{ item }}">
            </div>
        </form>

    </div>
</div>


{% endfor %}
{% endblock %}